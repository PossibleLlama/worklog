config:
  inherit-env: true
  # Expects the tests to be ran from the root of project
  dir: e2e

tests:
  print root:
    command: worklog print
    stdout:
      line-count: 0
    stderr:
      line-count: 23
      lines:
        1: "Error: one flag is required"
    exit-code: 1

  print today - long:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" --today
    stdout:
      contains:
        - "ID: "
        - "Title: "
        - "Description: "
        - "When: "
    exit-code: 0

  print today - short:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -t
    stdout:
      contains:
        - "ID: "
        - "Title: "
        - "Description: "
        - "When: "
    exit-code: 0

  print week - long:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" --thisWeek
    stdout:
      contains:
        - "ID: "
        - "Title: "
        - "Description: "
        - "When: "
    exit-code: 0

  print week - short:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -w
    stdout:
      contains:
        - "ID: "
        - "Title: "
        - "Description: "
        - "When: "
    exit-code: 0

  print startDate only:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" --startDate "$(date '+%Y-%m-%d')"
    stdout:
      contains:
        - "ID: "
        - "Title: "
        - "Description: "
        - "When: "
    exit-code: 0

  print startDate and endDate:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" --startDate "$(date '+%Y-%m-%d')" --endDate "$(date '+%Y-%m-%d')"
    stdout:
      contains:
        - "ID: "
        - "Title: "
        - "Description: "
        - "When: "
    exit-code: 0

  print endDate only:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" --endDate "$(date '+%Y-%m-%d')"
    stdout:
      line-count: 0
    stderr:
      line-count: 23
      lines:
        1: "Error: one flag is required"
    exit-code: 1

  print single ID only:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -j $(worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -tj | jq -r .[0].id) | jq length
    stdout:
      line-count: 1
      lines:
        1: "1"
    exit-code: 0

  print multiple IDs only:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -j $(worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -tj | jq -r .[0].id) $(worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -tj | jq -r .[1].id) | jq length
    stdout:
      line-count: 1
      lines:
        1: "2"
    exit-code: 0

  print pretty - long:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -t --pretty
    stdout:
      contains:
        - "ID: "
        - "Title: "
        - "Description: "
        - "When: "
      not-contains:
        - "Revision: "
    exit-code: 0

  print pretty - short:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -tp
    stdout:
      contains:
        - "ID: "
        - "Title: "
        - "Description: "
        - "When: "
      not-contains:
        - "Revision: "
    exit-code: 0

  print json - long:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -t --json
    stdout:
      line-count: 1
    exit-code: 0

  print json - short:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -tj
    stdout:
      line-count: 1
    exit-code: 0

  print yaml - long:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -t --yaml
    stdout:
      contains:
        - "- id: "
        - "  title: "
        - "  description: "
        - "  when: "
      not-contains:
        - "  revision: "
    exit-code: 0

  print yaml - short:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -ty
    stdout:
      contains:
        - "- id: "
        - "  title: "
        - "  description: "
        - "  when: "
      not-contains:
        - "  revision: "
    exit-code: 0

  print all - long:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -tp --all
    stdout:
      contains:
        - "ID: "
        - "Revision: "
        - "Title: "
        - "Description: "
        - "When: "
    exit-code: 0

  print all - short:
    command: worklog print --repo "bolt" --repoPath "/tmp/e2e.db" -tap
    stdout:
      contains:
        - "ID: "
        - "Revision: "
        - "Title: "
        - "Description: "
        - "When: "
    exit-code: 0
