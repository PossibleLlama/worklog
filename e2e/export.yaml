config:
  inherit-env: true
  # Expects the tests to be ran from the root of project
  dir: e2e

tests:
  export root:
    command: ./worklog export
    stdout:
      line-count: 1
      lines:
        1: "Saved export file"
    exit-code: 0

  change output to different but valid path:
    command: ./worklog export --path "/tmp/export-valid-path.json"
    stdout:
      line-count: 1
      lines:
        1: "Saved export file"
    exit-code: 0

  check export file from bolt:
    command: ./worklog --repo bolt --repoPath "/tmp/export-check.db" create --title "foo" && ./worklog export --repo bolt --repoPath "/tmp/export-check.db" --path "/tmp/export-check-file.json" && cat "/tmp/export-check-file.json" | jq length
    stdout:
      line-count: 4
      lines:
        1: "Saving file..."
        2: "Saved file"
        3: "Saved export file"
        4: "1"
    exit-code: 0

  check export file from legacy:
    command: ./worklog --repo legacy create --title "foo" && ./worklog export --repo legacy --path "/tmp/export-check-file.json" && cat "/tmp/export-check-file.json" | jq length
    stdout:
      line-count: 4
      lines:
        1: "Saving file..."
        2: "Saved file"
        3: "Saved export file"
        4: "1"
    exit-code: 0
